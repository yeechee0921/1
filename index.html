import React, { useState, useEffect } from 'react';
import { Calendar, Clock, Users, Car, MapPin, Phone, Plus, Search, FileText, Download, MessageCircle } from 'lucide-react';

const TransportManagementSystem = () => {
  const [currentDate, setCurrentDate] = useState(new Date());
  const [selectedDay, setSelectedDay] = useState('monday');
  const [viewMode, setViewMode] = useState('daily'); // daily, weekly, students, reports, whatsapp
  const [searchTerm, setSearchTerm] = useState('');

  // è”ç³»äººæ•°æ®åº“
  const contacts = {
    morningUncle: { name: 'æ—©ä¸Šç­Uncle', phone: '60123456789' }, // æ›¿æ¢ä¸ºå®é™…ç”µè¯
    afternoonUncle: { name: 'ä¸‹åˆç­Uncle', phone: '60123456788' }, // æ›¿æ¢ä¸ºå®é™…ç”µè¯
    center: { name: 'è¡¥ä¹ ä¸­å¿ƒ', phone: '60123456787' } // æ›¿æ¢ä¸ºå®é™…ç”µè¯
  };

  // å­¦ç”Ÿæ•°æ®åº“
  const studentsDatabase = {
    // Yçº§å­¦ç”Ÿ
    'Y1': [
      { name: 'éƒ‘ä¿æ´', english: 'Zheng Li Jie', school: 'Aæ ¡', phone: '', address: '' },
      { name: 'ä¿æ´', english: 'Li Jie', school: 'Aæ ¡', phone: '', address: '45 Lorong Batu Nilam 35B, BBT' },
      { name: 'Emily', english: 'Emily', school: 'Aæ ¡', phone: '', address: '' },
      { name: 'Dexter', english: 'Dexter', school: '', phone: '', address: '14 jalan batu arang' }
    ],
    'Y2': [
      { name: 'é™ˆæŸç¥¥', english: 'Chen Bo Xiang', school: 'Aæ ¡', phone: '', address: '' },
      { name: 'é™ˆå®¶æƒ', english: 'Chen Jia Quan', school: 'Aæ ¡', phone: '', address: '' },
      { name: 'ç‹æ–‡æ³°', english: 'Wang Wen Tai', school: 'Aæ ¡', phone: '012-5798976 (çˆ¸)', address: '' },
      { name: 'æ´ªæƒŸå“²', english: 'Hong Wei Zhe', school: 'Aæ ¡', phone: '016-3220173 (å¦ˆ)', address: '8, Jalan Jenaris 2, Bandar Botanic' },
      { name: 'æ½˜æ¬£è¹', english: 'Pan Xin Ying', school: 'Aæ ¡', phone: '019-3377883 (å¦ˆ)', address: '27, Jalan Jelai(Toyotaå‚å¯¹é¢)', aunty: true },
      { name: 'æ·èƒ½', english: 'Jie Neng', school: 'Aæ ¡', phone: '', address: '35, lorong mesra 2,Taman Chi liung', aunty: true },
      { name: 'é»„å®‡å“²', english: 'Huang Yu Zhe', school: '', phone: '', address: '8, Jalan Jenaris 2, Bandar Botanic' },
      { name: 'li wen', english: 'Li Wen', school: '', phone: '', address: '' },
      { name: 'ä¿é›¯', english: 'Li Wen', school: 'Aæ ¡', phone: '', address: '45 Lorong Batu Nilam 35B, BBT' }
    ],
    'Y3': [
      { name: 'é™ˆæ•å§¿', english: 'Chen Min Zhi', school: 'é’å¹´', phone: '', address: '70, Jalan Pandamaran Jaya 18' },
      { name: 'æ•å§¿', english: 'Min Zi', school: 'é’å¹´', phone: '', address: '70, Jalan Pandamaran Jaya 18' },
      { name: 'å¾å¦¤å½¤', english: 'Xu Yu Tong', school: 'Aæ ¡', phone: '011-10049498 (å¦ˆ)', address: '' },
      { name: 'æ—éŸ¦é¢–', english: 'Lin Wei Ying', school: 'Aæ ¡', phone: '014-3490602 (çˆ¸)', address: '' },
      { name: 'ç‹å¥•çš“', english: 'Wang Yi Hao', school: 'Aæ ¡', phone: '', address: 'No 71 jalan selasih off telok gadong klang selangor 41100' },
      { name: 'ç‹æ¡“æµ©', english: 'Wang Huan Hao', school: 'Aæ ¡', phone: '', address: '17 Lorong Kemenyan 1B, Persiaran Raja Muda Musa', aunty: true },
      { name: 'æ¡“æµ©', english: 'Huan Hao', school: 'Aæ ¡', phone: '', address: '17 Lorong Kemenyan 1B, Persiaran Raja Muda Musa' },
      { name: 'æ½˜ç®è¹', english: 'Pan Pei Ying', school: 'Aæ ¡', phone: '019-3377883 (å¦ˆ)', address: '27, Jalan Jelai(Toyotaå‚å¯¹é¢)', aunty: true },
      { name: 'å¶å­ç¿”', english: 'Ye Zi Xiang', school: '', phone: '', address: '43 Lorong Batu Nilam 33C, BBT2' },
      { name: 'å­ç¿”', english: 'Zi Xiang', school: '', phone: '', address: '43 Lorong Batu Nilam 33C, BBT2' },
      { name: 'éƒ­å‹‡å°Š', english: 'Guo Yong Zun', school: 'Aæ ¡', phone: '', address: '' },
      { name: 'æ…§å©·', english: 'Hui Ting', school: '', phone: '', address: '26 lorong permai 3E/KS5' }
    ],
    'Y4': [
      { name: 'éƒ‘æ˜Šç¥¥', english: 'Zheng Hao Xiang', school: 'Aæ ¡', phone: '012-3548293 (å¦ˆ)', address: '45 Lorong Batu Nilam 35B, BBT' },
      { name: 'éƒ‘æ˜Šç¿”', english: 'Zheng Hao Xiang', school: 'Aæ ¡', phone: '012-3548293 (å¦ˆ)', address: '45 Lorong Batu Nilam 35B, BBT' },
      { name: 'æ¨æºé¦¨', english: 'Yang Kai Xin', school: 'Aæ ¡', phone: '012-6652355(å¦ˆ)', address: '' },
      { name: 'æ—æµ©å®‡', english: 'Lin Hao Yu', school: 'Aæ ¡', phone: '', address: '' },
      { name: 'é»„æ¡”å¨', english: 'Huang Jie Wei', school: 'Aæ ¡', phone: '019-2148655 (çˆ¸)', address: '' },
      { name: 'å­™æ¹˜å€ª', english: 'Sun Xiang Ni', school: 'Aæ ¡', phone: '012-9431884 (å¦ˆ)', address: '898, Jalan Sekinchanæ–°æ‘', aunty: true },
      { name: 'æ½˜å‹ç››', english: 'Dylan', school: 'Aæ ¡', phone: '019-3377883 (å¦ˆ)', address: '' },
      { name: 'é™ˆç´«æ¸²', english: 'Chen Zi Xuan', school: 'Aæ ¡', phone: '', address: '' },
      { name: 'ä¿æ©', english: 'Li En', school: 'Aæ ¡', phone: '', address: '45 Lorong Batu Nilam 35B, BBT' },
      { name: 'éƒ­å‹‡è€€', english: 'Guo Yong Yao', school: 'Aæ ¡', phone: '', address: '' }
    ],
    'Y5': [
      { name: 'é™ˆæ¬£æ…§', english: 'Chen Xin Hui', school: 'Aæ ¡', phone: '011-11980200 (å¦ˆ)', address: '' },
      { name: 'æ—è¯—é¢–', english: 'Lin Shi Ying', school: 'Aæ ¡', phone: '014-3490602 (çˆ¸)', address: '861, Jalan Merbau, Pandamaran æ–°æ‘' },
      { name: 'è¯—é¢–', english: 'Shi Ying', school: 'Aæ ¡', phone: '014-3490602 (çˆ¸)', address: '861, Jalan Merbau, Pandamaran æ–°æ‘' },
      { name: 'éŸ¦é¢–', english: 'Wei Ying', school: 'Aæ ¡', phone: '014-3490602 (çˆ¸)', address: '861, Jalan Merbau, Pandamaran æ–°æ‘' },
      { name: 'é™ˆèŠ¯èŒ¹', english: 'Chen Xin Ru', school: 'Aæ ¡', phone: '016-2978928(å¦ˆ)', address: '' },
      { name: 'è¾¾éŸ¦å¨œ', english: 'Darswinah', school: 'Aæ ¡', phone: '', address: '' }
    ],
    'Y6': [
      { name: 'æéš½é¢‰', english: 'Li Jun Jie', school: 'Aæ ¡', phone: '', address: '' },
      { name: 'éƒ­è¹è¹', english: 'Guo Ying Ying', school: 'Aæ ¡', phone: '', address: '' },
      { name: 'åˆ˜ä¸½ç…Š', english: 'Liu Li Xuan', school: 'é’å¹´', phone: '019-2485553 (å¦ˆ)', address: '' },
      { name: 'æ—å®—æ¯…', english: 'Lin Zong Yi', school: 'Bæ ¡', phone: '019-4314917 (çˆ¸)', address: 'PT 24429, Jalan Aman off Kampung Idaman' },
      { name: 'Samicha', english: 'Samicha', school: 'Bæ ¡', phone: '', address: '39, Jalan Pandamaran Jaya 101J/KS5' },
      { name: 'èç±³ä½³', english: 'Samicha', school: 'Bæ ¡', phone: '', address: '39, Jalan Pandamaran Jaya 101J/KS5, Taman Ehsan Jaya' },
      { name: 'å¶å“²ç‚œ', english: 'Ye Zhe Wei', school: '', phone: '018-2408331', address: '43 Lorong Batu Nilam 33C, BBT2' },
      { name: 'å“²ç‚œ', english: 'Zhe Wei', school: 'Aæ ¡', phone: '018-2408331', address: '43 Lorong Batu Nilam 33C, BBT2' },
      { name: 'å¶è¿›æ°', english: 'Ye Jin Jie', school: '', phone: '012-6713386', address: '9, Lorong Batu Nilam 15D, BBT' },
      { name: 'æ²ˆæ–‡çª', english: 'Shen Wen Qi', school: '', phone: '012-2055304', address: '97, Solok Pendamar Indah 5A(Petronasåé¢)' },
      { name: 'è”¡ç«‹æ¨', english: 'Cai Li Yang', school: 'Bæ ¡', phone: '013-3888711', address: '10, Lorong Permai 6A, Taman Kota Pendamar' },
      { name: 'Dylan', english: 'Dylan', school: '', phone: '', address: '14 jalan batu arang' }
    ],
    // Fçº§å­¦ç”Ÿ
    'F1': [
      { name: 'ç¿Šæº', english: 'Yi Kai', school: '', phone: '', address: '' },
      { name: 'ä¿ç²', english: 'Li Ling', school: '', phone: '', address: '' },
      { name: 'é’°ç’‡', english: 'Yu Xuan', school: '', phone: '', address: '' },
      { name: 'å˜‰æ©', english: 'Jia En', school: '', phone: '', address: '' },
      { name: 'åˆ˜è£”ç³', english: 'Lau Elaine', school: '', phone: '', address: 'no 43 jalan sambau 15b,taman bayu perdana,41200 klang,selangor' },
      { name: 'è°¢ä¿Šçƒ½', english: 'Xie Jun Feng', school: 'Ampuan', phone: '016-2032379 (çˆ¸)', address: '' },
      { name: 'è°¢æ¸…é›¯', english: 'Xie Qing Wen', school: 'Ampuan', phone: '016-2032379 (çˆ¸)', address: '' },
      { name: 'æ¸…é›¯', english: 'Qing Wen', school: 'Ampuan', phone: '', address: '' },
      { name: 'ä¿Šçƒ½', english: 'Jun Feng', school: 'Ampuan', phone: '', address: '' }
    ],
    'F2': [
      { name: 'æƒ ç’‡', english: 'Hui Xuan', school: '', phone: '', address: '' },
      { name: 'ç®ä»ª', english: 'Pei Yi', school: '', phone: '', address: '' },
      { name: 'Doreen', english: 'Doreen', school: '', phone: '', address: '' },
      { name: 'jun xuan', english: 'Jun Xuan', school: '', phone: '', address: '' },
      { name: 'è°¢ä¿Šç¿”', english: 'Xie Jun Xiang', school: '', phone: '', address: '' }
    ],
    'F3': [
      { name: 'ç»´æ€', english: 'Wei Si', school: '', phone: '', address: '6A lorong permai 3E/ks5, jalan pandamar villa, pandamaran 42000 pelabuhan klang' },
      { name: 'é¢œå®‡å›', english: 'Yan Yu Jun', school: 'Ampuan', phone: '', address: '8, Lorong Batu Nilam 30B, BBT2' }
    ],
    'F4': [
      { name: 'å·§è¹', english: 'Qiao Ying', school: '', phone: '', address: '24, Jalan Pandamaran Jaya 91A' },
      { name: 'å‘¨æ—»æ™´', english: 'Zhou Min Qing', school: '', phone: '019-8069337', address: '5, Jalan Mawar 2/ks4 Taman Raja Uda' },
      { name: 'åˆ˜æ€æ©', english: 'Liu Si En', school: '', phone: '', address: '10, Lorong Batu Nilam14D, BBT1' },
      { name: 'æ—å‡¯ä¼¦', english: 'Lin Kai Lun', school: '', phone: '012-3431220 / 0182996233', address: '62, Jalan Cucur Atap (é è¿‘é’å¹´å­¦æ ¡ï¼‰' },
      { name: 'min cheng', english: 'Min Cheng', school: '', phone: '', address: '' }
    ],
    'F5': [
      { name: 'ç¥¥ä½‘', english: 'Xiang You', school: '', phone: '016-3464816', address: '7 jalan pendamar indah 1, taman pendamar indah' },
      { name: 'æ²ºé¸¿', english: 'Tian Hong', school: '', phone: '', address: '' }
    ],
    // Others
    'Teachers': [
      { name: 'åè€å¸ˆ', english: 'Teacher Hua', school: '', phone: '', address: '' },
      { name: 'å®‡è€å¸ˆ', english: 'Teacher Yu', school: '', phone: '', address: '' }
    ],
    'Others': [
      { name: 'æ…§é›¯', english: 'Hui Wen', school: '', phone: '', address: '15 Lorong Aur(é’å¹´å­¦æ ¡æ—ï¼‰' }
    ]
  };

  // æ¯æ—¥è½½é€å®‰æ’
  const weeklySchedule = {
    monday: {
      morning: [
        { time: '9:00AM-9:30AM', type: 'COME', students: ['Teacher Hua', 'Teacher Yu'] },
        { time: '9:30AM', type: 'BACK', students: ['F2 æƒ ç’‡', 'F2 ç®ä»ª', 'F2 Doreen', 'F1 åˆ˜è£”ç³'] },
        { time: '10:00AM-10:30AM', type: 'COME', students: ['æ…§é›¯'] },
        { time: '11:00PM', type: 'BACK', students: ['F1 ç¿Šæº', 'F1 ä¿ç²', 'F1 é’°ç’‡', 'F1 å˜‰æ©'] }
      ],
      afternoon: [
        { 
          time: '4:30PM-5:30PM', 
          type: 'è½½æ¥', 
          students: [
            'Y6 å¶è¿›æ° (012-6713386)',
            'Y6 æ²ˆæ–‡çª (012-2055304)',
            'Y6 è”¡ç«‹æ¨ (013-3888711)',
            'Y6 å¶å“²ç‚œ (018-2408331)'
          ]
        },
        { 
          time: '5:30PM', 
          type: 'è½½å›', 
          students: [
            'Y3 é™ˆæ•å§¿',
            'Y4 éƒ‘æ˜Šç¿”',
            'Y4ä¿æ© Y1ä¿æ´ Y2ä¿é›¯',
            'Y2 é»„å®‡å“²',
            'F4 å·§è¹',
            'Y3 å¶å­ç¿”',
            'F5 ç¥¥ä½‘'
          ], 
          auntyStudents: [
            'Y4 å­™æ¹˜å€ª',
            'Y3 ç‹æ¡“æµ©'
          ]
        },
        { 
          time: '6:30PM', 
          type: 'å»AMPUANè½½æ¥ä¸­å¿ƒ', 
          students: ['F1 è°¢æ¸…é›¯', 'F1 è°¢ä¿Šçƒ½', 'F2 è°¢ä¿Šç¿”'] 
        },
        { 
          time: '7:00PM', 
          type: 'è½½å›(Pandamaran->Bukit Tinggi->æ¸¯å£)', 
          students: [
            'Y6 èç±³ä½³',
            'Y6 æ²ˆæ–‡çª',
            'Y6 æ—å®—æ¯… Y4 æ—é›¨å½¤',
            'Y5 è¯—é¢– éŸ¦é¢–',
            'Y6 å¶å“²ç‚œ',
            'F3 é¢œå®‡å›'
          ]
        }
      ]
    },
    tuesday: {
      morning: [
        { time: '9:00AM-9:30AM', type: 'COME', students: ['Teacher Hua', 'Teacher Yu'] },
        { time: '9:30AM', type: 'BACK', students: ['F2 Doreen', 'F1 ç¿Šæº', 'F1 ä¿ç²', 'F1 é’°ç’‡'] }
      ],
      afternoon: [
        { 
          time: '4:30PM-5:30PM', 
          type: 'è½½æ¥', 
          students: [
            'Y6 å¶è¿›æ° (012-6713386)',
            'Y6 æ²ˆæ–‡çª (012-2055304)',
            'F4 å‘¨æ—»æ™´ (019-8069337)',
            'F4 æ—å‡¯ä¼¦ (012-3431220)',
            'Y6 è”¡ç«‹æ¨ (013-3888711)',
            'Y6 å¶å“²ç‚œ (018-2408331)'
          ]
        },
        { 
          time: '5:30PM', 
          type: 'è½½å›', 
          students: [
            'Y3 é™ˆæ•å§¿',
            'Y4 éƒ‘æ˜Šç¿”',
            'Y4ä¿æ© Y1ä¿æ´ Y2ä¿é›¯',
            'Y2 é»„å®‡å“²',
            'Y3 å¶å­ç¿”'
          ], 
          auntyStudents: [
            'Y4 å­™æ¹˜å€ª',
            'Y3 æ½˜ç®è¹',
            'Y3 ç‹æ¡“æµ©'
          ]
        },
        { 
          time: '6:30PM', 
          type: 'å»AMPUANè½½æ¥ä¸­å¿ƒ', 
          students: ['F1 è°¢æ¸…é›¯', 'F1 è°¢ä¿Šçƒ½'] 
        },
        { 
          time: '7:00PM', 
          type: 'è½½å›(Pandamaran->Bukit Tinggi->æ¸¯å£)', 
          students: [
            'Y6 èç±³ä½³',
            'Y6 æ²ˆæ–‡çª',
            'Y6 æ—å®—æ¯… Y4 æ—é›¨å½¤',
            'Y5 è¯—é¢– éŸ¦é¢–',
            'Y6 å¶å“²ç‚œ',
            'F4 å·§è¹',
            'F4 å‘¨æ—»æ™´',
            'F4 åˆ˜æ€æ©',
            'F4 æ—å‡¯ä¼¦',
            'F3 é¢œå®‡å›'
          ]
        }
      ]
    },
    wednesday: {
      morning: [
        { time: '9:00AM-9:30AM', type: 'COME', students: ['Teacher Yu'] },
        { time: '9:30AM', type: 'BACK', students: ['F2 æƒ ç’‡', 'F2 ç®ä»ª', 'F1 ç¿Šæº', 'F1 ä¿ç²', 'F2 jun xuan', 'F1 åˆ˜è£”ç³'] },
        { time: '10:00AM-10:30AM', type: 'COME', students: ['æ…§é›¯'] },
        { time: '2:00PM-2:30PM', type: 'COME', students: ['Y2 li wen Y4 li en'] },
        { time: '2:50PM', type: 'TAKE FROM PAN A TO CENTER', students: [] },
        { time: '3:00PM', type: 'TAKE FROM PAN B TO CENTER', students: ['Y6 Samicha'] },
        { time: '3:30PM-4:00PM', type: 'COME', students: ['Y3 å­ç¿”', 'F4 min cheng', 'Y4 li en'] }
      ],
      afternoon: [
        { 
          time: '4:30PM-5:30PM', 
          type: 'è½½æ¥', 
          students: [
            'Y6 å¶è¿›æ° (012-6713386)',
            'Y6 å¶å“²ç‚œ (018-2408331)',
            'Y6 è”¡ç«‹æ¨ (013-3888711)'
          ]
        },
        { 
          time: '5:30PM', 
          type: 'è½½å›', 
          students: [
            'Y3 é™ˆæ•å§¿',
            'Y4 éƒ‘æ˜Šç¿”',
            'Y4ä¿æ© Y1ä¿æ´ Y2ä¿é›¯',
            'Y2 é»„å®‡å“²',
            'Y3 å¶å­ç¿”'
          ], 
          auntyStudents: [
            'Y4 å­™æ¹˜å€ª',
            'Y3 æ½˜ç®è¹',
            'Y3 ç‹æ¡“æµ©'
          ]
        },
        { 
          time: '6:30PM', 
          type: 'å»AMPUANè½½æ¥ä¸­å¿ƒ', 
          students: ['F1 è°¢æ¸…é›¯', 'F1 è°¢ä¿Šçƒ½', 'F2 è°¢ä¿Šç¿”'] 
        },
        { 
          time: '7:00PM', 
          type: 'è½½å›(Pandamaran->Bukit Tinggi->æ¸¯å£)', 
          students: [
            'Y6 èç±³ä½³',
            'Y6 æ—å®—æ¯… Y4 æ—é›¨å½¤',
            'Y5 è¯—é¢– éŸ¦é¢–',
            'Y6 å¶å“²ç‚œ',
            'F4 å‘¨æ—»æ™´',
            'F3 é¢œå®‡å› åè€å¸ˆ å®‡è€å¸ˆ'
          ]
        }
      ]
    },
    thursday: {
      morning: [
        { time: '9:00AM-9:30AM', type: 'COME', students: ['Teacher Yu'] },
        { time: '9:30AM', type: 'BACK', students: ['F2 æƒ ç’‡', 'F2 ç®ä»ª', 'F1 ç¿Šæº', 'F1 ä¿ç²', 'F1 é’°ç’‡'] },
        { time: '10:00AM-10:30AM', type: 'COME', students: ['æ…§é›¯'] },
        { time: '2:00PM-2:30PM', type: 'COME', students: ['Y2 li wen Y4 li en'] },
        { time: '2:45PM-4:00PM', type: 'COME', students: ['Y3 å­ç¿”', 'F4 å·§è¹', 'F4 æ—»æ™´', 'F4 åˆ˜æ€æ©', 'F4 å‡¯ä¼¦'] },
        { time: '3:30PM', type: 'TAKE FROM SCHOOL TO CENTER', students: ['Y3 Chen Min Zhi (é’å¹´)', 'Y6 Liu Li Xuan (é’å¹´)'] }
      ],
      afternoon: [
        { 
          time: '4:30PM', 
          type: 'ä»Aæ ¡è½½æ¥è¡¥ä¹ ', 
          students: [
            'Y4 æ—æµ©å®‡',
            'Y4 é»„æ¡”å¨',
            'Y3 ç‹æ¡“æµ©',
            'Y4 æ½˜å‹ç››',
            'Y5 æ—è¯—é¢–',
            'Y5 è¾¾éŸ¦å¨œ',
            'Y6 å¶å“²ç‚œ',
            'Y4 éƒ­å‹‡è€€'
          ]
        },
        { 
          time: '4:30PM-5:30PM', 
          type: 'è½½æ¥', 
          students: [
            'Y6 å¶è¿›æ° (012-6713386)',
            'Y6 æ²ˆæ–‡çª (012-2055304)',
            'F5 ç¥¥ä½‘ (016-3464816)',
            'Y6 è”¡ç«‹æ¨ (013-3888711)'
          ]
        },
        { 
          time: '5:30PM', 
          type: 'è½½å›', 
          students: [
            'Y3 é™ˆæ•å§¿',
            'Y4 éƒ‘æ˜Šç¿”',
            'Y4ä¿æ© Y1ä¿æ´ Y2ä¿é›¯',
            'Y2 é»„å®‡å“²',
            'F3 ç»´æ€',
            'Y3 å¶å­ç¿”'
          ], 
          auntyStudents: [
            'Y4 å­™æ¹˜å€ª',
            'Y3 æ½˜ç®è¹',
            'Y3 ç‹æ¡“æµ©'
          ]
        },
        { 
          time: '6:30PM', 
          type: 'å»AMPUANè½½æ¥ä¸­å¿ƒ', 
          students: ['F1 è°¢æ¸…é›¯', 'F1 è°¢ä¿Šçƒ½'] 
        },
        { 
          time: '7:00PM', 
          type: 'è½½å›(Pandamaran->Bukit Tinggi->æ¸¯å£)', 
          students: [
            'åè€å¸ˆ å®‡è€å¸ˆ',
            'Y6 èç±³ä½³',
            'Y6 æ²ˆæ–‡çª',
            'Y6 æ—å®—æ¯… Y4 æ—é›¨å½¤',
            'Y5 è¯—é¢– éŸ¦é¢–',
            'Y6 å¶å“²ç‚œ',
            'F5 ç¥¥ä½‘',
            'F4 å·§è¹',
            'F4 å‘¨æ—»æ™´',
            'F4 åˆ˜æ€æ©',
            'F4 æ—å‡¯ä¼¦'
          ]
        }
      ]
    },
    friday: {
      morning: [
        { time: '9:00AM-9:30AM', type: 'COME', students: ['Teacher Yu', 'Teacher Hua'] },
        { time: '9:30AM', type: 'BACK', students: ['F2 æƒ ç’‡', 'F2 jun xuan', 'F1 åˆ˜è£”ç³'] },
        { time: '10:00AM-10:30AM', type: 'COME', students: ['æ…§é›¯'] },
        { time: '11:00AM', type: 'BACK', students: ['F2 ç®ä»ª', 'F1 ç¿Šæº', 'F1 ä¿ç²', 'F1 é’°ç’‡', 'F1 å˜‰æ©'] },
        { time: '2:00PM-2:30PM', type: 'COME', students: ['F3 ç»´æ€', 'Y2 li wen'] },
        { time: '2:50PM', type: 'TAKE FROM PAN A TO CENTER', students: [] },
        { time: '3:20PM-4:00PM', type: 'COME', students: ['Y3 å­ç¿”', 'F5 æ²ºé¸¿', 'Y4 li en'] },
        { time: '3:30PM', type: 'TAKE FROM SCHOOL TO CENTER', students: ['Y6 Liu Li Xuan (é’å¹´)'] },
        { time: '4:00PM', type: 'BACK', students: ['F3 ç»´æ€'] }
      ],
      afternoon: [
        { 
          time: '4:30PM-5:30PM', 
          type: 'è½½æ¥', 
          students: [
            'Y6 å¶è¿›æ° (012-6713386)',
            'Y6 æ²ˆæ–‡çª (012-2055304)',
            'Y6 å¶å“²ç‚œ (018-2408331)',
            'Y6 è”¡ç«‹æ¨ (013-3888711)'
          ]
        },
        { 
          time: '5:30PM', 
          type: 'è½½å›', 
          students: [
            'Y3 é™ˆæ•å§¿',
            'Y4 éƒ‘æ˜Šç¿”',
            'Y4ä¿æ© Y1ä¿æ´ Y2ä¿é›¯',
            'Y2 é»„å®‡å“²',
            'Y3 å¶å­ç¿”',
            'Y2 æ·èƒ½',
            'Y3 å­ç¿”',
            'F3 é¢œå®‡å›'
          ], 
          auntyStudents: [
            'Y4 å­™æ¹˜å€ª',
            'Y3 æ½˜ç®è¹',
            'Y3 ç‹æ¡“æµ©'
          ]
        },
        { 
          time: '6:30PM', 
          type: 'å»AMPUANè½½æ¥ä¸­å¿ƒ', 
          students: ['F2 è°¢ä¿Šç¿”', 'F1 è°¢æ¸…é›¯', 'F1 è°¢ä¿Šçƒ½'] 
        },
        { 
          time: '7:00PM', 
          type: 'è½½å›(Pandamaran->Bukit Tinggi->æ¸¯å£)', 
          students: [
            'åè€å¸ˆ å®‡è€å¸ˆ',
            'Y6 èç±³ä½³',
            'Y6 æ²ˆæ–‡çª',
            'Y6 æ—å®—æ¯… Y4 æ—é›¨å½¤',
            'Y5 è¯—é¢– éŸ¦é¢–',
            'Y6 å¶å“²ç‚œ'
          ]
        }
      ]
    },
    saturday: {
      morning: [
        { 
          time: '9:45AM-10:00AM', 
          type: 'COME', 
          students: ['Y3 å­ç¿”'] 
        },
        { 
          time: '10:30AM-11:00AM', 
          type: 'COME', 
          students: ['Y3 æ•å§¿'] 
        },
        { 
          time: '12:00PM-12:30PM', 
          type: 'COME', 
          students: [
            'Y6 å“²ç‚œ',
            'Y6 èç±³ä½³', 
            'Y6 Dylan Y1 Dexter'
          ] 
        },
        { 
          time: '12:30PM', 
          type: 'BACK', 
          students: [
            'Y3 å­ç¿”',
            'Y3 æ•å§¿'
          ] 
        },
        { 
          time: '2:00PM', 
          type: 'BACK', 
          students: [
            'Y6 å“²ç‚œ',
            'Y6 èç±³ä½³',
            'Y6 å®—æ¯… é›¨å½¤',
            'éŸ¦é¢– è¯—é¢– Roggers',
            'æ¡“æµ©',
            'Y6 Dylan Y1 Dexter'
          ] 
        }
      ],
      afternoon: []
    }
  };

  const daysOfWeek = [
    { key: 'monday', label: 'æ˜ŸæœŸä¸€', english: 'Monday' },
    { key: 'tuesday', label: 'æ˜ŸæœŸäºŒ', english: 'Tuesday' },
    { key: 'wednesday', label: 'æ˜ŸæœŸä¸‰', english: 'Wednesday' },
    { key: 'thursday', label: 'æ˜ŸæœŸå››', english: 'Thursday' },
    { key: 'friday', label: 'æ˜ŸæœŸäº”', english: 'Friday' },
    { key: 'saturday', label: 'æ˜ŸæœŸå…­', english: 'Saturday' }
  ];

  // è·å–å­¦ç”Ÿè¯¦ç»†ä¿¡æ¯
  const getStudentInfo = (studentName) => {
    for (const grade in studentsDatabase) {
      const student = studentsDatabase[grade].find(s => 
        s.name === studentName || s.english === studentName || studentName.includes(s.name) ||
        s.name.includes(studentName) || s.english.includes(studentName)
      );
      if (student) {
        return { ...student, grade };
      }
    }
    return null;
  };

  // æœç´¢å­¦ç”Ÿ
  const searchStudents = (term) => {
    const results = [];
    for (const grade in studentsDatabase) {
      studentsDatabase[grade].forEach(student => {
        if (student.name.toLowerCase().includes(term.toLowerCase()) || 
            student.english.toLowerCase().includes(term.toLowerCase())) {
          results.push({ ...student, grade });
        }
      });
    }
    return results;
  };

  // è·å–ä»Šå¤©æ˜¯æ˜ŸæœŸå‡ 
  const getTodayKey = () => {
    const days = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
    return days[currentDate.getDay()];
  };

  // è§£æå­¦ç”Ÿä¿¡æ¯ (ä»æ˜¾ç¤ºæ–‡æœ¬ä¸­æå–å­¦ç”Ÿåå­—å’Œè”ç³»ä¿¡æ¯)
  const parseStudentInfo = (studentText) => {
    // ç§»é™¤æ‹¬å·å†…çš„åœ°å€å’Œç”µè¯ä¿¡æ¯ï¼Œåªä¿ç•™å­¦ç”Ÿå§“å
    const cleanName = studentText.replace(/\([^)]*\)/g, '').trim();
    const phoneMatch = studentText.match(/\(([0-9-]+[^)]*)\)/);
    const phone = phoneMatch ? phoneMatch[1] : '';
    
    return {
      name: cleanName,
      phone: phone
    };
  };

  // ç”Ÿæˆæ—©ä¸Šç­Uncleè‹±æ–‡é€šçŸ¥
  const generateMorningUncleMessage = (dayKey) => {
    const schedule = weeklySchedule[dayKey];
    if (!schedule || !schedule.morning) return '';

    const today = new Date();
    const dayName = daysOfWeek.find(d => d.key === dayKey)?.english || dayKey;
    const dateStr = today.toLocaleDateString('en-US', { 
      year: 'numeric', 
      month: 'long', 
      day: 'numeric' 
    });

    let message = `ğŸšŒ MORNING TRANSPORT SCHEDULE\n`;
    message += `ğŸ“… ${dayName}, ${dateStr}\n\n`;

    schedule.morning.forEach((session, idx) => {
      message += `â° ${session.time} - ${session.type.toUpperCase()}\n`;
      session.students.forEach((student, studentIdx) => {
        const studentInfo = parseStudentInfo(student);
        const info = getStudentInfo(studentInfo.name);
        const englishName = info?.english || studentInfo.name;
        message += `${studentIdx + 1}. ${englishName}\n`;
      });
      message += `\n`;
    });

    message += `âœ… Please confirm receipt of this schedule.\n`;
    message += `ğŸ“± Contact center if any questions.`;

    return message;
  };

  // ç”Ÿæˆä¸‹åˆç­Uncleä¸­æ–‡é€šçŸ¥
  const generateAfternoonUncleMessage = (dayKey) => {
    const schedule = weeklySchedule[dayKey];
    if (!schedule || !schedule.afternoon) return '';

    const today = new Date();
    const dayName = daysOfWeek.find(d => d.key === dayKey)?.label || dayKey;
    const dateStr = today.toLocaleDateString('zh-CN', { 
      year: 'numeric', 
      month: 'long', 
      day: 'numeric' 
    });

    let message = `ğŸšŒ ä¸‹åˆç­è½½é€å®‰æ’\n`;
    message += `ğŸ“… ${dayName} ${dateStr}\n\n`;

    schedule.afternoon.forEach((session, idx) => {
      message += `â° ${session.time} ${session.type}\n`;
      session.students.forEach((student, studentIdx) => {
        message += `${studentIdx + 1}. ${student}\n`;
      });
      
      if (session.auntyStudents) {
        message += `\nğŸ  Auntyè½½é€å­¦ç”Ÿ:\n`;
        session.auntyStudents.forEach((student, studentIdx) => {
          message += `${studentIdx + 1}. ${student} (å®¶é•¿è½½)\n`;
        });
      }
      message += `\n`;
    });

    message += `âœ… è¯·ç¡®è®¤æ”¶åˆ°æ­¤å®‰æ’\n`;
    message += `ğŸ“± æœ‰é—®é¢˜è¯·è”ç³»ä¸­å¿ƒ`;

    return message;
  };

  // ç”ŸæˆAuntyè½½é€é€šçŸ¥
  const generateAuntyMessage = (dayKey) => {
    const schedule = weeklySchedule[dayKey];
    const auntyStudents = [];
    
    if (schedule) {
      [...(schedule.morning || []), ...(schedule.afternoon || [])].forEach(session => {
        if (session.auntyStudents) {
          session.auntyStudents.forEach(student => {
            const studentInfo = parseStudentInfo(student);
            const info = getStudentInfo(studentInfo.name);
            auntyStudents.push({
              name: student,
              time: session.time,
              type: session.type,
              phone: info?.phone || '',
              address: info?.address || ''
            });
          });
        }
      });
    }

    if (auntyStudents.length === 0) return '';

    const today = new Date();
    const dayName = daysOfWeek.find(d => d.key === dayKey)?.label || dayKey;
    const dateStr = today.toLocaleDateString('zh-CN', { 
      year: 'numeric', 
      month: 'long', 
      day: 'numeric' 
    });

    let message = `ğŸ  å®¶é•¿è½½é€æé†’\n`;
    message += `ğŸ“… ${dayName} ${dateStr}\n\n`;
    message += `ä»¥ä¸‹å­¦ç”Ÿéœ€è¦å®¶é•¿è‡ªè¡Œè½½é€ï¼š\n\n`;

    auntyStudents.forEach((student, idx) => {
      message += `${idx + 1}. ${student.name}\n`;
      message += `   æ—¶é—´: ${student.time} ${student.type}\n`;
      if (student.address) {
        message += `   åœ°å€: ${student.address}\n`;
      }
      message += `\n`;
    });

    message += `è¯·å„ä½å®¶é•¿å‡†æ—¶è½½é€ï¼Œè°¢è°¢é…åˆï¼\n`;
    message += `ğŸ“± å¦‚æœ‰é—®é¢˜è¯·è”ç³»è¡¥ä¹ ä¸­å¿ƒ`;

    return message;
  };

  // ç”ŸæˆWhatsAppé“¾æ¥
  const generateWhatsAppLink = (message, phone = '') => {
    const encodedMessage = encodeURIComponent(message);
    if (phone) {
      return `https://wa.me/${phone}?text=${encodedMessage}`;
    } else {
      return `https://wa.me/?text=${encodedMessage}`;
    }
  };

  // å¤åˆ¶åˆ°å‰ªè´´æ¿
  const copyToClipboard = async (text) => {
    try {
      await navigator.clipboard.writeText(text);
      alert('æ¶ˆæ¯å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
    } catch (err) {
      // å¦‚æœclipboard APIä¸å¯ç”¨ï¼Œä½¿ç”¨å¤‡ç”¨æ–¹æ³•
      const textArea = document.createElement('textarea');
      textArea.value = text;
      document.body.appendChild(textArea);
      textArea.select();
      document.execCommand('copy');
      document.body.removeChild(textArea);
      alert('æ¶ˆæ¯å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
    }
  };

  // æ¸²æŸ“æ¯æ—¥æ—¶é—´è¡¨
  const renderDailySchedule = (dayKey) => {
    const schedule = weeklySchedule[dayKey];
    if (!schedule) return <div className="text-gray-500">ä»Šå¤©æ²¡æœ‰è½½é€å®‰æ’</div>;

    return (
      <div className="space-y-6">
        {schedule.morning && (
          <div>
            <h3 className="text-lg font-semibold text-blue-700 mb-3 flex items-center gap-2">
              <Clock className="w-5 h-5" />
              ä¸Šåˆæ—¶é—´è¡¨
            </h3>
            {schedule.morning.map((session, idx) => (
              <div key={idx} className="bg-blue-50 p-4 rounded-lg mb-3">
                <div className="flex items-center gap-2 mb-2">
                  <span className="font-medium text-blue-800">{session.time}</span>
                  <span className="text-sm bg-blue-200 px-2 py-1 rounded">{session.type}</span>
                </div>
                <div className="grid gap-2">
                  {session.students.map((student, studentIdx) => {
                    const studentInfo = parseStudentInfo(student);
                    const info = getStudentInfo(studentInfo.name);
                    return (
                      <div key={studentIdx} className="flex items-center justify-between bg-white p-2 rounded border">
                        <span className="font-medium">{studentIdx + 1}. {student}</span>
                        {info && (
                          <div className="flex items-center gap-2 text-sm text-gray-600">
                            {info.school && <span className="bg-gray-100 px-2 py-1 rounded">{info.school}</span>}
                            {(info.phone || studentInfo.phone) && <Phone className="w-4 h-4" />}
                            {info.address && <MapPin className="w-4 h-4" />}
                          </div>
                        )}
                      </div>
                    );
                  })}
                </div>
              </div>
            ))}
          </div>
        )}

        {schedule.afternoon && (
          <div>
            <h3 className="text-lg font-semibold text-green-700 mb-3 flex items-center gap-2">
              <Clock className="w-5 h-5" />
              ä¸‹åˆæ—¶é—´è¡¨
            </h3>
            {schedule.afternoon.map((session, idx) => (
              <div key={idx} className="bg-green-50 p-4 rounded-lg mb-3">
                <div className="flex items-center gap-2 mb-2">
                  <span className="font-medium text-green-800">{session.time}</span>
                  <span className="text-sm bg-green-200 px-2 py-1 rounded">{session.type}</span>
                </div>
                <div className="grid gap-2">
                  {session.students.map((student, studentIdx) => {
                    const studentInfo = parseStudentInfo(student);
                    const info = getStudentInfo(studentInfo.name);
                    return (
                      <div key={studentIdx} className="flex items-center justify-between bg-white p-2 rounded border">
                        <span className="font-medium">{studentIdx + 1}. {student}</span>
                        {info && (
                          <div className="flex items-center gap-2 text-sm text-gray-600">
                            {info.school && <span className="bg-gray-100 px-2 py-1 rounded">{info.school}</span>}
                            {(info.phone || studentInfo.phone) && <Phone className="w-4 h-4" />}
                            {info.address && <MapPin className="w-4 h-4" />}
                          </div>
                        )}
                      </div>
                    );
                  })}
                  {session.auntyStudents && (
                    <div className="mt-2 p-2 bg-orange-100 rounded border-l-4 border-orange-400">
                      <h4 className="font-medium text-orange-800 mb-1">Auntyè½½é€å­¦ç”Ÿ:</h4>
                      {session.auntyStudents.map((student, studentIdx) => {
                        const studentInfo = parseStudentInfo(student);
                        const info = getStudentInfo(studentInfo.name);
                        return (
                          <div key={studentIdx} className="flex items-center justify-between text-sm">
                            <span>{studentIdx + 1}. {student} (Auntyè½½)</span>
                            {info && info.address && (
                              <MapPin className="w-4 h-4 text-orange-600" />
                            )}
                          </div>
                        );
                      })}
                    </div>
                  )}
                </div>
              </div>
            ))}
          </div>
        )}
      </div>
    );
  };

  // æ¸²æŸ“å­¦ç”Ÿç®¡ç†ç•Œé¢
  const renderStudentsView = () => {
    const filteredStudents = searchTerm ? searchStudents(searchTerm) : [];
    
    return (
      <div className="space-y-6">
        <div className="flex items-center gap-4 mb-6">
          <div className="relative flex-1">
            <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4" />
            <input
              type="text"
              placeholder="æœç´¢å­¦ç”Ÿå§“å..."
              className="w-full pl-10 pr-4 py-2 border rounded-lg"
              value={searchTerm}
              onChange={(e) => setSearchTerm(e.target.value)}
            />
          </div>
        </div>

        {searchTerm ? (
          <div>
            <h3 className="text-lg font-semibold mb-4">æœç´¢ç»“æœ ({filteredStudents.length})</h3>
            <div className="grid gap-4">
              {filteredStudents.map((student, idx) => (
                <div key={idx} className="bg-white p-4 rounded-lg border shadow-sm">
                  <div className="flex justify-between items-start mb-2">
                    <div>
                      <h4 className="font-medium text-lg">{student.grade} {student.name}</h4>
                      <p className="text-gray-600">{student.english}</p>
                    </div>
                    {student.aunty && (
                      <span className="bg-orange-100 text-orange-800 px-2 py-1 rounded text-sm">Auntyè½½</span>
                    )}
                  </div>
                  {student.school && (
                    <p className="text-sm text-gray-600 mb-1">
                      <span className="font-medium">å­¦æ ¡:</span> {student.school}
                    </p>
                  )}
                  {student.phone && (
                    <p className="text-sm text-gray-600 mb-1">
                      <Phone className="inline w-4 h-4 mr-1" />
                      {student.phone}
                    </p>
                  )}
                  {student.address && (
                    <p className="text-sm text-gray-600">
                      <MapPin className="inline w-4 h-4 mr-1" />
                      {student.address}
                    </p>
                  )}
                </div>
              ))}
            </div>
          </div>
        ) : (
          <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
            {Object.entries(studentsDatabase).map(([grade, students]) => (
              <div key={grade} className="bg-white p-4 rounded-lg border shadow-sm">
                <h3 className="font-semibold text-lg mb-3 text-blue-700">{grade} å¹´çº§ ({students.length}äºº)</h3>
                <div className="space-y-2">
                  {students.map((student, idx) => (
                    <div key={idx} className="flex justify-between items-center py-1">
                      <span className="text-sm">{student.name}</span>
                      {student.aunty && (
                        <span className="bg-orange-100 text-orange-700 px-2 py-1 rounded text-xs">Aunty</span>
                      )}
                    </div>
                  ))}
                </div>
              </div>
            ))}
          </div>
        )}
      </div>
    );
  };

  // æ¸²æŸ“WhatsAppé€šçŸ¥ç•Œé¢
  const renderWhatsAppView = () => {
    const morningMessage = generateMorningUncleMessage(selectedDay);
    const afternoonMessage = generateAfternoonUncleMessage(selectedDay);
    const auntyMessage = generateAuntyMessage(selectedDay);

    return (
      <div className="space-y-6">
        <div className="bg-green-50 p-4 rounded-lg mb-6">
          <h2 className="text-xl font-semibold text-green-800 mb-2 flex items-center gap-2">
            <MessageCircle className="w-6 h-6" />
            WhatsAppé€šçŸ¥ä¸­å¿ƒ
          </h2>
          <p className="text-green-600">é€‰æ‹©æ—¥æœŸå¹¶å‘é€è½½é€å®‰æ’ç»™ç›¸å…³äººå‘˜ï¼Œæ”¯æŒè‡ªåŠ¨æ ¼å¼åŒ–å’Œç›´æ¥å‘é€</p>
        </div>

        {/* æ—¥æœŸé€‰æ‹© */}
        <div className="flex flex-wrap gap-2 mb-6">
          {daysOfWeek.map((day) => {
            const schedule = weeklySchedule[day.key];
            let totalSessions = 0;
            if (schedule) {
              totalSessions += (schedule.morning || []).length + (schedule.afternoon || []).length;
            }
            
            return (
              <button
                key={day.key}
                onClick={() => setSelectedDay(day.key)}
                className={`px-4 py-2 rounded-lg font-medium transition-colors ${
                  selectedDay === day.key 
                    ? 'bg-green-600 text-white' 
                    : day.key === getTodayKey()
                    ? 'bg-green-100 text-green-800 border-2 border-green-300'
                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                }`}
              >
                {day.label}
                {totalSessions > 0 && (
                  <span className="ml-1 text-xs bg-blue-500 text-white px-1 rounded">{totalSessions}ç­</span>
                )}
                {day.key === getTodayKey() && (
                  <span className="ml-1 text-xs bg-green-500 text-white px-1 rounded">ä»Šå¤©</span>
                )}
              </button>
            );
          })}
        </div>

        <div className="grid lg:grid-cols-3 gap-6">
          {/* æ—©ä¸Šç­Uncleé€šçŸ¥ */}
          <div className="bg-blue-50 border border-blue-200 rounded-lg p-6">
            <div className="flex items-center gap-2 mb-4">
              <div className="w-3 h-3 bg-blue-500 rounded-full"></div>
              <h3 className="text-lg font-semibold text-blue-800">æ—©ä¸Šç­Uncle (è‹±æ–‡)</h3>
            </div>
            
            {morningMessage ? (
              <div className="space-y-4">
                <div className="bg-white p-4 rounded border text-sm font-mono whitespace-pre-wrap max-h-64 overflow-y-auto">
                  {morningMessage}
                </div>
                <div className="flex gap-2">
                  <button
                    onClick={() => window.open(generateWhatsAppLink(morningMessage, contacts.morningUncle.phone), '_blank')}
                    className="flex-1 bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg flex items-center justify-center gap-2 transition-colors"
                  >
                    <span>ğŸ“±</span>
                    å‘é€ç»™æ—©ä¸Šç­Uncle
                  </button>
                  <button
                    onClick={() => copyToClipboard(morningMessage)}
                    className="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg transition-colors"
                    title="å¤åˆ¶æ¶ˆæ¯"
                  >
                    ğŸ“‹
                  </button>
                </div>
              </div>
            ) : (
              <div className="text-gray-500 text-center py-8">
                ä»Šå¤©æ²¡æœ‰æ—©ä¸Šç­å®‰æ’
              </div>
            )}
          </div>

          {/* ä¸‹åˆç­Uncleé€šçŸ¥ */}
          <div className="bg-orange-50 border border-orange-200 rounded-lg p-6">
            <div className="flex items-center gap-2 mb-4">
              <div className="w-3 h-3 bg-orange-500 rounded-full"></div>
              <h3 className="text-lg font-semibold text-orange-800">ä¸‹åˆç­Uncle (ä¸­æ–‡)</h3>
            </div>
            
            {afternoonMessage ? (
              <div className="space-y-4">
                <div className="bg-white p-4 rounded border text-sm whitespace-pre-wrap max-h-64 overflow-y-auto">
                  {afternoonMessage}
                </div>
                <div className="flex gap-2">
                  <button
                    onClick={() => window.open(generateWhatsAppLink(afternoonMessage, contacts.afternoonUncle.phone), '_blank')}
                    className="flex-1 bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg flex items-center justify-center gap-2 transition-colors"
                  >
                    <span>ğŸ“±</span>
                    å‘é€ç»™ä¸‹åˆç­Uncle
                  </button>
                  <button
                    onClick={() => copyToClipboard(afternoonMessage)}
                    className="bg-orange-500 hover:bg-orange-600 text-white px-3 py-2 rounded-lg transition-colors"
                    title="å¤åˆ¶æ¶ˆæ¯"
                  >
                    ğŸ“‹
                  </button>
                </div>
              </div>
            ) : (
              <div className="text-gray-500 text-center py-8">
                ä»Šå¤©æ²¡æœ‰ä¸‹åˆç­å®‰æ’
              </div>
            )}
          </div>

          {/* Auntyè½½é€é€šçŸ¥ */}
          <div className="bg-purple-50 border border-purple-200 rounded-lg p-6">
            <div className="flex items-center gap-2 mb-4">
              <div className="w-3 h-3 bg-purple-500 rounded-full"></div>
              <h3 className="text-lg font-semibold text-purple-800">Auntyè½½é€æé†’</h3>
            </div>
            
            {auntyMessage ? (
              <div className="space-y-4">
                <div className="bg-white p-4 rounded border text-sm whitespace-pre-wrap max-h-64 overflow-y-auto">
                  {auntyMessage}
                </div>
                <div className="flex gap-2">
                  <button
                    onClick={() => window.open(generateWhatsAppLink(auntyMessage), '_blank')}
                    className="flex-1 bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg flex items-center justify-center gap-2 transition-colors"
                  >
                    <span>ğŸ“±</span>
                    å‘é€ç»™å®¶é•¿ç¾¤
                  </button>
                  <button
                    onClick={() => copyToClipboard(auntyMessage)}
                    className="bg-purple-500 hover:bg-purple-600 text-white px-3 py-2 rounded-lg transition-colors"
                    title="å¤åˆ¶æ¶ˆæ¯"
                  >
                    ğŸ“‹
                  </button>
                </div>
              </div>
            ) : (
              <div className="text-gray-500 text-center py-8">
                ä»Šå¤©æ²¡æœ‰Auntyè½½é€å®‰æ’
              </div>
            )}
          </div>
        </div>

        {/* ä½¿ç”¨è¯´æ˜ */}
        <div className="bg-gray-50 p-6 rounded-lg">
          <h3 className="text-lg font-semibold text-gray-800 mb-3">ğŸ“– ä½¿ç”¨è¯´æ˜</h3>
          <div className="grid md:grid-cols-3 gap-4 text-sm">
            <div className="bg-blue-100 p-3 rounded">
              <h4 className="font-medium text-blue-800 mb-1">ğŸŒ… æ—©ä¸Šç­Uncle</h4>
              <p className="text-blue-700">å‘é€è‹±æ–‡ç‰ˆä¸Šåˆè½½é€å®‰æ’ï¼ŒåŒ…å«æ‰€æœ‰æ—©ä¸Šçš„æ¥é€æ—¶é—´å’Œå­¦ç”Ÿåå•ã€‚</p>
            </div>
            <div className="bg-orange-100 p-3 rounded">
              <h4 className="font-medium text-orange-800 mb-1">ğŸŒ† ä¸‹åˆç­Uncle</h4>
              <p className="text-orange-700">å‘é€ä¸­æ–‡ç‰ˆä¸‹åˆè½½é€å®‰æ’ï¼ŒåŒ…å«ä¸‹åˆç­å’Œæ™šä¸Šçš„æ‰€æœ‰å®‰æ’ã€‚</p>
            </div>
            <div className="bg-purple-100 p-3 rounded">
              <h4 className="font-medium text-purple-800 mb-1">ğŸ  Auntyè½½é€</h4>
              <p className="text-purple-700">æé†’å®¶é•¿è‡ªè¡Œè½½é€çš„å­¦ç”Ÿåå•å’Œæ—¶é—´ï¼Œå¯ç¾¤å‘ç»™å®¶é•¿ç¾¤ã€‚</p>
            </div>
          </div>
          
          <div className="mt-4 p-3 bg-yellow-100 rounded border-l-4 border-yellow-400">
            <p className="text-yellow-800 text-sm">
              ğŸ’¡ <strong>å°è´´å£«:</strong> ç‚¹å‡»"å‘é€ç»™XXX"ä¼šç›´æ¥æ‰“å¼€WhatsAppå¹¶å‘é€ç»™æŒ‡å®šè”ç³»äººï¼Œç‚¹å‡»"ğŸ“‹"æŒ‰é’®å¯å¤åˆ¶æ¶ˆæ¯åˆ°å‰ªè´´æ¿ã€‚
              å»ºè®®æ¯å¤©æ—©ä¸Šå‘é€ç»™ç›¸å…³äººå‘˜ï¼Œç¡®ä¿è½½é€å®‰æ’é¡ºåˆ©è¿›è¡Œã€‚
            </p>
          </div>
          
          <div className="mt-3 p-3 bg-blue-100 rounded border-l-4 border-blue-400">
            <p className="text-blue-800 text-sm">
              âš™ï¸ <strong>è”ç³»äººè®¾ç½®:</strong> å¦‚éœ€ä¿®æ”¹Uncleçš„ç”µè¯å·ç ï¼Œè¯·åœ¨ä»£ç ä¸­æ›´æ–°contactså¯¹è±¡ã€‚
              å½“å‰è®¾ç½® - æ—©ä¸Šç­Uncle: {contacts.morningUncle.phone} | ä¸‹åˆç­Uncle: {contacts.afternoonUncle.phone}
            </p>
          </div>
        </div>
      </div>
    );
  };
  const renderReportsView = () => {
    const uncleStudents = [];
    const auntyStudents = [];
    
    // ç»Ÿè®¡Uncleå’ŒAuntyè½½é€çš„å­¦ç”Ÿ
    Object.entries(studentsDatabase).forEach(([grade, students]) => {
      students.forEach(student => {
        if (student.aunty) {
          auntyStudents.push({ ...student, grade });
        } else {
          uncleStudents.push({ ...student, grade });
        }
      });
    });

    return (
      <div className="space-y-6">
        <div className="grid md:grid-cols-2 gap-6">
          <div className="bg-blue-50 p-6 rounded-lg">
            <h3 className="text-xl font-semibold text-blue-800 mb-4 flex items-center gap-2">
              <Car className="w-6 h-6" />
              Uncleè½½é€å­¦ç”Ÿ ({uncleStudents.length}äºº)
            </h3>
            <div className="space-y-2 max-h-96 overflow-y-auto">
              {uncleStudents.map((student, idx) => (
                <div key={idx} className="bg-white p-3 rounded border flex justify-between items-center">
                  <div>
                    <span className="font-medium">{student.grade} {student.name}</span>
                    {student.school && <span className="text-gray-600 ml-2">({student.school})</span>}
                  </div>
                  {student.phone && <Phone className="w-4 h-4 text-blue-600" />}
                </div>
              ))}
            </div>
          </div>

          <div className="bg-orange-50 p-6 rounded-lg">
            <h3 className="text-xl font-semibold text-orange-800 mb-4 flex items-center gap-2">
              <Users className="w-6 h-6" />
              Auntyè½½é€å­¦ç”Ÿ ({auntyStudents.length}äºº)
            </h3>
            <div className="space-y-2 max-h-96 overflow-y-auto">
              {auntyStudents.map((student, idx) => (
                <div key={idx} className="bg-white p-3 rounded border flex justify-between items-center">
                  <div>
                    <span className="font-medium">{student.grade} {student.name}</span>
                    {student.school && <span className="text-gray-600 ml-2">({student.school})</span>}
                  </div>
                  {student.address && <MapPin className="w-4 h-4 text-orange-600" />}
                </div>
              ))}
            </div>
          </div>
        </div>

        <div className="bg-gray-50 p-6 rounded-lg">
          <h3 className="text-xl font-semibold text-gray-800 mb-4">æ¯æ—¥è½½é€ç»Ÿè®¡</h3>
          <div className="grid md:grid-cols-5 gap-4">
            {daysOfWeek.map((day) => {
              const schedule = weeklySchedule[day.key];
              let totalStudents = 0;
              let auntyCount = 0;
              
              if (schedule) {
                [...(schedule.morning || []), ...(schedule.afternoon || [])].forEach(session => {
                  totalStudents += session.students.length;
                  if (session.auntyStudents) {
                    auntyCount += session.auntyStudents.length;
                  }
                });
              }
              
              return (
                <div key={day.key} className="bg-white p-4 rounded border text-center">
                  <h4 className="font-medium text-gray-800">{day.label}</h4>
                  <div className="mt-2 space-y-1">
                    <div className="text-blue-600 font-semibold">Uncle: {totalStudents}äºº</div>
                    <div className="text-orange-600 font-semibold">Aunty: {auntyCount}äºº</div>
                  </div>
                </div>
              );
            })}
          </div>
        </div>
      </div>
    );
  };

  return (
    <div className="max-w-7xl mx-auto p-6 bg-gray-50 min-h-screen">
      <div className="bg-white rounded-lg shadow-lg">
        {/* Header */}
        <div className="bg-gradient-to-r from-blue-600 to-green-600 text-white p-6 rounded-t-lg">
          <h1 className="text-3xl font-bold flex items-center gap-3">
            <Calendar className="w-8 h-8" />
            è½½é€æ—¶é—´è¡¨ç®¡ç†ç³»ç»Ÿ
          </h1>
          <p className="mt-2 opacity-90">ç®¡ç†æ¯æ—¥Uncleå’ŒAuntyè½½é€å®‰æ’</p>
        </div>

        {/* Navigation */}
        <div className="border-b bg-gray-50">
          <div className="flex flex-wrap gap-1 p-4">
            <button
              onClick={() => setViewMode('daily')}
              className={`px-4 py-2 rounded-lg font-medium transition-colors ${
                viewMode === 'daily' ? 'bg-blue-600 text-white' : 'bg-white text-gray-700 hover:bg-blue-50'
              }`}
            >
              æ¯æ—¥æ—¶é—´è¡¨
            </button>
            <button
              onClick={() => setViewMode('weekly')}
              className={`px-4 py-2 rounded-lg font-medium transition-colors ${
                viewMode === 'weekly' ? 'bg-green-600 text-white' : 'bg-white text-gray-700 hover:bg-green-50'
              }`}
            >
              å‘¨æ—¶é—´è¡¨
            </button>
            <button
              onClick={() => setViewMode('students')}
              className={`px-4 py-2 rounded-lg font-medium transition-colors ${
                viewMode === 'students' ? 'bg-purple-600 text-white' : 'bg-white text-gray-700 hover:bg-purple-50'
              }`}
            >
              å­¦ç”Ÿç®¡ç†
            </button>
            <button
              onClick={() => setViewMode('reports')}
              className={`px-4 py-2 rounded-lg font-medium transition-colors ${
                viewMode === 'reports' ? 'bg-orange-600 text-white' : 'bg-white text-gray-700 hover:bg-orange-50'
              }`}
            >
              ç»Ÿè®¡æŠ¥å‘Š
            </button>
            <button
              onClick={() => setViewMode('whatsapp')}
              className={`px-4 py-2 rounded-lg font-medium transition-colors flex items-center gap-2 ${
                viewMode === 'whatsapp' ? 'bg-green-600 text-white' : 'bg-white text-gray-700 hover:bg-green-50'
              }`}
            >
              <MessageCircle className="w-4 h-4" />
              WhatsAppé€šçŸ¥
            </button>
          </div>
        </div>

        {/* Content */}
        <div className="p-6">
          {viewMode === 'daily' && (
            <div>
              <div className="flex flex-wrap gap-2 mb-6">
                {daysOfWeek.map((day) => (
                  <button
                    key={day.key}
                    onClick={() => setSelectedDay(day.key)}
                    className={`px-4 py-2 rounded-lg font-medium transition-colors ${
                      selectedDay === day.key 
                        ? 'bg-blue-600 text-white' 
                        : day.key === getTodayKey()
                        ? 'bg-green-100 text-green-800 border-2 border-green-300'
                        : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                    }`}
                  >
                    {day.label}
                    {day.key === getTodayKey() && (
                      <span className="ml-1 text-xs bg-green-500 text-white px-1 rounded">ä»Šå¤©</span>
                    )}
                  </button>
                ))}
              </div>
              
              <div className="bg-blue-50 p-4 rounded-lg mb-6">
                <h2 className="text-xl font-semibold text-blue-800">
                  {daysOfWeek.find(d => d.key === selectedDay)?.label} è½½é€å®‰æ’
                </h2>
                <p className="text-blue-600 mt-1">
                  {new Date().toLocaleDateString('zh-CN', { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                  })}
                </p>
              </div>
              
              {renderDailySchedule(selectedDay)}
            </div>
          )}

          {viewMode === 'weekly' && (
            <div className="space-y-8">
              <h2 className="text-2xl font-semibold text-gray-800">å‘¨è½½é€æ—¶é—´è¡¨æ¦‚è§ˆ</h2>
              {daysOfWeek.map((day) => (
                <div key={day.key} className="border rounded-lg p-6 bg-white shadow-sm">
                  <h3 className="text-xl font-semibold text-gray-800 mb-4 flex items-center gap-2">
                    {day.label} ({day.english})
                    {day.key === getTodayKey() && (
                      <span className="bg-green-500 text-white px-2 py-1 rounded text-sm">ä»Šå¤©</span>
                    )}
                  </h3>
                  {renderDailySchedule(day.key)}
                </div>
              ))}
            </div>
          )}

          {viewMode === 'students' && renderStudentsView()}
          {viewMode === 'reports' && renderReportsView()}
          {viewMode === 'whatsapp' && renderWhatsAppView()}
        </div>
      </div>
    </div>
  );
};

export default TransportManagementSystem;
